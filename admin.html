<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Admin Koleksiku ‚Äì Shopee & TikTok</title>
  <style>
    body{
      background:#0b1622;
      color:#e5e7eb;
      font-family:system-ui,-apple-system,"Segoe UI",sans-serif;
      padding:20px;
    }
    .wrap{max-width:720px;margin:0 auto;}
    h1{margin:0 0 6px;text-align:center;}
    .sub{text-align:center;font-size:13px;color:#9ca3af;margin-bottom:18px;}

    .tabs{
      display:flex;
      background:#111827;
      border-radius:999px;
      overflow:hidden;
      margin-bottom:16px;
      border:1px solid #1f2937;
    }
    .tab{
      flex:1;
      text-align:center;
      padding:8px 0;
      font-size:14px;
      font-weight:600;
      cursor:pointer;
      color:#9ca3af;
      user-select:none;
    }
    .tab.active{
      background:#f97316;
      color:#fff;
    }

    .panel{display:none;}
    .panel.active{display:block;}

    .box{
      background:#111827;
      border-radius:12px;
      padding:14px;
      border:1px solid #1f2937;
      box-shadow:0 4px 15px rgba(0,0,0,.4);
      margin-bottom:16px;
    }
    .box h2{margin:0 0 6px;font-size:16px;}
    .box p{margin:4px 0 10px;font-size:13px;color:#cbd5f5;}

    textarea{
      width:100%;
      height:120px;
      background:#020617;
      color:#e5e7eb;
      border-radius:8px;
      border:1px solid #1f2937;
      padding:8px;
      font-size:13px;
      resize:vertical;
    }
    button{
      margin-top:8px;
      padding:9px 16px;
      border-radius:999px;
      border:none;
      background:#f97316;
      color:#fff;
      font-weight:600;
      font-size:13px;
      cursor:pointer;
    }
    button:hover{background:#fb923c;}

    #log{
      margin-top:18px;
      background:#020617;
      border-radius:8px;
      border:1px solid #1f2937;
      padding:10px;
      height:220px;
      overflow-y:auto;
      font-family:ui-monospace,Menlo,Consolas,monospace;
      font-size:12px;
      white-space:pre-line;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Admin Koleksiku</h1>
    <div class="sub">Tambah Shopee & TikTok ‚Üí langsung nulis ke Sheet ‚Äúdata‚Äù</div>

    <div class="tabs">
      <div id="tab-shopee" class="tab active" onclick="setTab('shopee')">üõí Shopee</div>
      <div id="tab-tiktok" class="tab" onclick="setTab('tiktok')">üéµ TikTok</div>
    </div>

    <!-- Shopee -->
    <div id="panel-shopee" class="panel active">
      <div class="box">
        <h2>üõí Tambah link Shopee</h2>
        <p>Tempel link Shopee <b>1 per baris</b>. Sistem akan ambil judul & gambar otomatis.</p>
        <textarea id="shopee-links" placeholder="https://s.shopee.co.id/xxx
https://s.shopee.co.id/yyy"></textarea>
        <button onclick="kirimShopee()">Kirim Shopee ke Sheet</button>
      </div>
    </div>

    <!-- TikTok -->
    <div id="panel-tiktok" class="panel">
      <div class="box">
        <h2>üéµ Tambah link TikTok</h2>
        <p>Tempel link TikTok <b>1 per baris</b>. Sistem akan coba ambil judul & thumbnail.</p>
        <textarea id="tiktok-links" placeholder="https://www.tiktok.com/@user/video/...
https://vt.tiktok.com/xxx"></textarea>
        <button onclick="kirimTikTok()">Kirim TikTok ke Sheet</button>
      </div>
    </div>

    <div id="log">Log siap‚Ä¶</div>
  </div>

  <script>
    // GANTI ini dengan URL WebApp kamu sendiri
    const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbwb8nmu8OU56T3zSY98Gg2jNyxjHxNB4sWXPbVXjXmOFoF511fuTjS6U5MrkBUIs9NS/exec"; 

    function setTab(which){
      document.getElementById("tab-shopee").classList.toggle("active", which === "shopee");
      document.getElementById("tab-tiktok").classList.toggle("active", which === "tiktok");
      document.getElementById("panel-shopee").classList.toggle("active", which === "shopee");
      document.getElementById("panel-tiktok").classList.toggle("active", which === "tiktok");
    }

    function log(msg){
      const el = document.getElementById("log");
      el.textContent += "\n" + msg;
      el.scrollTop = el.scrollHeight;
    }

    function parseLines(textareaId){
      const raw = document.getElementById(textareaId).value.trim();
      if (!raw) return [];
      return raw.split(/\r?\n/)
        .map(s => s.trim())
        .filter(Boolean);
    }

    async function kirimShopee(){
      document.getElementById("log").textContent = "‚è≥ Mulai proses Shopee...\n";
      const list = parseLines("shopee-links");
      if (!list.length){
        alert("Isi dulu link Shopee-nya bro.");
        return;
      }
      log("Total link Shopee: " + list.length);

      try {
        await fetch(WEBAPP_URL, {
          method: "POST",
          mode: "no-cors",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ shopee_links: list })
        });
        log("‚úî Permintaan Shopee dikirim (mode no-cors).");
      } catch(e){
        log("‚úñ ERROR Shopee: " + e);
      }
      log("üéâ Selesai. Cek sheet 'data' apakah baris Shopee sudah masuk.");
    }

    async function kirimTikTok(){
      document.getElementById("log").textContent = "‚è≥ Mulai proses TikTok...\n";
      const list = parseLines("tiktok-links");
      if (!list.length){
        alert("Isi dulu link TikTok-nya bro.");
        return;
      }
      log("Total link TikTok: " + list.length);

      try {
        await fetch(WEBAPP_URL, {
          method: "POST",
          mode: "no-cors",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ tiktok_links: list })
        });
        log("‚úî Permintaan TikTok dikirim (mode no-cors).");
      } catch(e){
        log("‚úñ ERROR TikTok: " + e);
      }
      log("üéâ Selesai. Cek sheet 'data' apakah baris TikTok sudah masuk.");
    }
  </script>
</body>
</html>
